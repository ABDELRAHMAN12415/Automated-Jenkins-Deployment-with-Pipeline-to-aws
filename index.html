<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game with Frame and Trials</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }

        #game-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        #game-canvas {
            border: 1px solid black;
            display: block;
        }
    </style>
</head>

<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>
    </div>

    <script>
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');

        // Set canvas size to fullscreen
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            tileCountX = Math.floor(canvas.width / tileSize);
            tileCountY = Math.floor(canvas.height / tileSize);
        }

        const tileSize = 20; // Size of each tile (snake block)
        let tileCountX, tileCountY;
        resizeCanvas(); // Set initial size

        window.addEventListener('resize', resizeCanvas);

        let snake;
        let dx, dy;
        let food;
        let score = 0;
        let trials = 0; // Number of trials (games played)

        // Initialize the game
        function initializeGame() {
            snake = [{ x: 10, y: 10 }];
            dx = 1;
            dy = 0;
            score = 0;
            trials++; // Increment trials on each game start

            food = {
                x: Math.floor(Math.random() * (tileCountX - 2)) + 1,
                y: Math.floor(Math.random() * (tileCountY - 2)) + 1,
            };
        }

        initializeGame(); // Initialize the first game

        function draw() {
            // Clear the canvas
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw frame/border
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 4;
            ctx.strokeRect(0, 0, canvas.width, canvas.height);

            // Draw snake
            ctx.fillStyle = 'green';
            for (let i = 0; i < snake.length; i++) {
                ctx.fillRect(snake[i].x * tileSize, snake[i].y * tileSize, tileSize, tileSize);
            }

            // Draw food
            ctx.fillStyle = 'red';
            ctx.fillRect(food.x * tileSize, food.y * tileSize, tileSize, tileSize);

            // Draw score
            ctx.font = '20px Arial';
            ctx.fillStyle = 'white';
            ctx.fillText('Score: ' + score, 20, 30);

            // Draw trials (number of attempts)
            ctx.fillText('Trials: ' + trials, 20, 60);
        }

        function checkCollision() {
            // Check collision with frame/borders (added 1 tile size to account for the frame)
            if (snake[0].x < 1 || snake[0].x >= tileCountX - 1 || snake[0].y < 1 || snake[0].y >= tileCountY - 1) {
                return true;
            }

            // Check collision with itself
            for (let i = 1; i < snake.length; i++) {
                if (snake[0].x === snake[i].x && snake[0].y === snake[i].y) {
                    return true;
                }
            }

            return false;
        }

        function update() {
            snake.unshift({ x: snake[0].x + dx, y: snake[0].y + dy });

            // Check if snake eats the food
            if (snake[0].x === food.x && snake[0].y === food.y) {
                score++;
                food.x = Math.floor(Math.random() * (tileCountX - 2)) + 1; // Ensure food doesn't spawn on frame
                food.y = Math.floor(Math.random() * (tileCountY - 2)) + 1;
            } else {
                snake.pop(); // Remove the tail
            }

            // End game if collision occurs
            if (checkCollision()) {
                clearInterval(gameInterval);
                alert('Game Over! Your score: ' + score);
                initializeGame(); // Re-initialize the game for a new trial
                gameInterval = setInterval(gameLoop, 100); // Restart the game loop
            }
        }

        // Game loop function to update and draw
        function gameLoop() {
            draw();
            update();
        }

        let gameInterval = setInterval(gameLoop, 100); // Start the game loop

        // Handle keyboard input for snake movement
        document.addEventListener('keydown', function (event) {
            if (event.keyCode === 37 && dx !== 1) { // Left arrow
                dx = -1;
                dy = 0;
            } else if (event.keyCode === 38 && dy !== 1) { // Up arrow
                dx = 0;
                dy = -1;
            } else if (event.keyCode === 39 && dx !== -1) { // Right arrow
                dx = 1;
                dy = 0;
            } else if (event.keyCode === 40 && dy !== -1) { // Down arrow
                dx = 0;
                dy = 1;
            }
        });
    </script>
</body>

</html>
